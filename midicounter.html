<!doctype html>
<html>
<body>
  <select id="midiSelect"></select>
  <h1 id="count">0</h1>

<script>
let count = 0;
let currentInput = null;

navigator.requestMIDIAccess().then(midi => {
  const select = document.getElementById("midiSelect");

  for (let input of midi.inputs.values()) {
    const opt = document.createElement("option");
    opt.value = input.id;
    opt.text = input.name;
    select.appendChild(opt);
  }

  select.onchange = () => {
    if (currentInput) currentInput.onmidimessage = null;
    currentInput = midi.inputs.get(select.value);
    currentInput.onmidimessage = msg => {
      const [status, note, vel] = msg.data;
      if ((status & 0xf0) === 0x90 && vel > 0) {
        count++;
        document.getElementById("count").innerText = count;
      }
    };
  };
});
</script>
</body>
</html>
